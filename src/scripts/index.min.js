$(function() {
    guedes.instancia();
})

var guedes = {
    imoveis: new Array(),
    instancia: function () {
        var that = this;
        that.carrega();
        that.eventos();
    },
    eventos: function () {
        $("button").on("click", function(obj) {
            var id = obj.currentTarget.id;
            switch(id) {
                case "Whatsapp":
                    window.location.href = "https://api.whatsapp.com/send?phone=5534992403928&text=Olá,%20quero%20saber%20mais%20sobre%20os%20imóveis%20disponíveis!";
                    break;
            }
        })
    },
    carrega: function () {
        var that = this;
        that.imoveis = new Array();
        $.getJSON("./src/assets/jsons/imoveis.json", function(data) {
            for(var i in data["lista"]) {
                var registro  = data["lista"][i];
                that.imoveis.push(registro);
            }
            console.log(that.imoveis);
            if (that.imoveis.length > 0) {
                var elemento = $('div[id=lista]');
                console.log(elemento);
                var texto = '';
                for(var i in that.imoveis) {
                    var registro = that.imoveis[i];
                    texto += '<div id="imovel">' +
                    '<img src="' + registro["imagem"] +'" alt="' + registro['titulo'] + '"/>' +
                    '<h3>' + registro['titulo'] + '</h3>' +
                    '<p>Bairro ' + registro['bairro'] + ', ' + registro['cidade'] + '</p>' +
                    '<p id="valor"><strong>' + parseFloat(registro['valor']).toLocaleString('pt-br',{style: 'currency', currency: 'BRL'}) + '</strong></p>' +
                    '<button id="C0' + i + '">Detalhe do Imóvel</button>' + 
                    '</div>'
                }
                elemento.append(texto);
            }
        })
    }
}